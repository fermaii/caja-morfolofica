<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caja Morfológica - Karl Gerstner</title>
    <style>
        /* Estética Suiza: Helvetica, limpieza y grillas */
        body { 
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; 
            padding: 40px; 
            background-color: #f0f0f0; 
            color: #1a1a1a;
            line-height: 1.4;
        }

        .container { 
            max-width: 1000px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border: 1px solid #ccc;
        }

        h1 { font-weight: 700; text-transform: uppercase; letter-spacing: -1px; margin-bottom: 5px; }
        .subtitle { color: #666; margin-bottom: 30px; border-bottom: 2px solid #000; padding-bottom: 10px; }

        /* Controles de Modo */
        .controls { margin-bottom: 20px; display: flex; gap: 10px; }
        button { 
            font-family: inherit; font-weight: bold; padding: 10px 20px; 
            border: 1px solid #000; cursor: pointer; transition: 0.2s;
        }
        .btn-edit { background: #000; color: #fff; }
        .btn-use { background: #fff; color: #000; }
        button:hover { opacity: 0.8; }

        /* Tabla Estilo Gerstner */
        table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 14px; }
        th, td { border: 1px solid #ccc; padding: 12px; vertical-align: top; }
        th { background: #f9f9f9; text-align: left; font-weight: 700; width: 150px; }

        /* Estados de celdas */
        .selectable { cursor: pointer; }
        .selectable:hover { background-color: #f0f0f0; }
        .selected { background-color: #000 !important; color: #fff !important; }
        
        .edit-input { 
            width: 100%; border: none; background: transparent; 
            font-family: inherit; font-size: inherit; outline: none;
        }
        .edit-input:focus { background: #fffde7; }

        /* Resultado */
        .result { 
            margin-top: 40px; padding: 20px; border-top: 2px solid #000;
            background: #f9f9f9; font-weight: bold;
        }
        .code-chain { font-size: 1.2em; letter-spacing: 1px; }
        
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>Caja Morfológica</h1>
    <div class="subtitle">Programa para soluciones de diseño / Basado en Karl Gerstner</div>

    <div class="controls">
        <button id="btnEdit" class="btn-use" onclick="setMode('edit')">Modo Edición (Configurar)</button>
        <button id="btnUse" class="btn-edit" onclick="setMode('use')">Modo Uso (Analizar)</button>
        <button onclick="addRow()">+ Añadir Parámetro</button>
    </div>

    <table id="morphTable">
        <thead>
            <tr>
                <th>Parámetro</th>
                <th>Opción 1</th>
                <th>Opción 2</th>
                <th>Opción 3</th>
                <th>Opción 4</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            </tbody>
    </table>

    <div class="result" id="resultArea">
        SOLUCIÓN OBTENIDA POR EL PROGRAMA:<br>
        <span class="code-chain" id="solutionPath">— — —</span>
    </div>
</div>

<script>
    let currentMode = 'edit';
    // Estructura inicial basada en tus imágenes
    let matrixData = [
        { param: "a. Base", opts: ["11. Palabra", "12. Abreviatura", "13. Grupo", "14. Combinado"] },
        { param: "b. Color", opts: ["11. Claro", "12. Medio", "13. Oscuro", "14. Combinado"] },
        { param: "c. Grosor", opts: ["31. Fino", "32. Normal", "33. Negra", "34. Combinado"] }
    ];

    let selections = {};

    function setMode(mode) {
        currentMode = mode;
        document.getElementById('btnEdit').className = (mode === 'edit' ? 'btn-edit' : 'btn-use');
        document.getElementById('btnUse').className = (mode === 'use' ? 'btn-edit' : 'btn-use');
        renderTable();
    }

    function addRow() {
        matrixData.push({ param: "Nuevo Parámetro", opts: ["", "", "", ""] });
        renderTable();
    }

    function updateData(rowIndex, optIndex, value) {
        if(optIndex === -1) {
            matrixData[rowIndex].param = value;
        } else {
            matrixData[rowIndex].opts[optIndex] = value;
        }
    }

    function selectOption(rowIndex, optIndex) {
        if(currentMode !== 'use') return;
        
        selections[rowIndex] = matrixData[rowIndex].opts[optIndex];
        renderTable();
        updateResult();
    }

    function updateResult() {
        const chain = Object.values(selections).filter(s => s !== "").join(' + ');
        document.getElementById('solutionPath').innerText = chain || "— — —";
    }

    function renderTable() {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';

        matrixData.forEach((row, rIdx) => {
            const tr = document.createElement('tr');
            
            // Columna de Parámetro
            const th = document.createElement('th');
            if(currentMode === 'edit') {
                th.innerHTML = `<input class="edit-input" value="${row.param}" onchange="updateData(${rIdx}, -1, this.value)">`;
            } else {
                th.innerText = row.param;
            }
            tr.appendChild(th);

            // Columnas de Opciones
            row.opts.forEach((opt, oIdx) => {
                const td = document.createElement('td');
                if(currentMode === 'edit') {
                    td.innerHTML = `<input class="edit-input" placeholder="..." value="${opt}" onchange="updateData(${rIdx}, ${oIdx}, this.value)">`;
                } else {
                    td.innerText = opt;
                    td.className = 'selectable' + (selections[rIdx] === opt ? ' selected' : '');
                    td.onclick = () => selectOption(rIdx, oIdx);
                }
                tr.appendChild(td);
            });

            tbody.appendChild(tr);
        });
    }

    // Iniciar
    renderTable();
</script>

</body>
</html>
